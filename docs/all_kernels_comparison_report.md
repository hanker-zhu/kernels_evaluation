# 多核函数框架性能对比报告

本报告对比 **GEMM**、**Softmax**、**LayerNorm** 等核函数在不同框架下的性能。


## GEMM 核函数对比

### 编译性能

| 框架 | 类型 | Warmup(ms) | 编译时间(ms) |
|------|------|------------|--------------|
| cuBLAS | AOT | - | 0 |
| CUTLASS | AOT | - | 0 |
| Triton | JIT | 311 | 1 |
| TileLang | JIT | 1165 | 87 |

### 运行性能

| 尺寸 | 框架 | 延迟(ms) | TFLOPS |
|------|------|----------|--------|
| 1024x1024x1024 | cuBLAS | 0.031 | 69745.20 |
| 1024x1024x1024 | CUTLASS | 0.033 | 64225.20 |
| 1024x1024x1024 | TileLang | 0.040 | 53773.13 |
| 1024x1024x1024 | Triton | 0.056 | 38674.11 |
| | | | |
| 2048x2048x2048 | cuBLAS | 0.135 | 126944.00 |
| 2048x2048x2048 | CUTLASS | 0.167 | 103068.00 |
| 2048x2048x2048 | TileLang | 0.186 | 92182.50 |
| 2048x2048x2048 | Triton | 0.195 | 88230.19 |
| | | | |
| 256x256x256 | cuBLAS | 0.011 | 3122.62 |
| 256x256x256 | TileLang | 0.012 | 2730.67 |
| 256x256x256 | CUTLASS | 0.013 | 2491.27 |
| 256x256x256 | Triton | 0.042 | 794.23 |
| | | | |
| 4096x4096x4096 | CUTLASS | 0.956 | 143795.00 |
| 4096x4096x4096 | cuBLAS | 0.968 | 141915.00 |
| 4096x4096x4096 | Triton | 1.015 | 135430.69 |
| 4096x4096x4096 | TileLang | 1.054 | 130435.11 |
| | | | |
| 512x512x512 | cuBLAS | 0.013 | 19897.10 |
| 512x512x512 | TileLang | 0.019 | 13797.05 |
| 512x512x512 | CUTLASS | 0.021 | 13013.70 |
| 512x512x512 | Triton | 0.041 | 6626.84 |
| | | | |

## SOFTMAX 核函数对比

### 编译性能

| 框架 | 类型 | Warmup(ms) | 编译时间(ms) |
|------|------|------------|--------------|
| cuBLAS | AOT | - | 0 |
| CUTLASS | AOT | - | 0 |
| Triton | JIT | 309 | 4 |
| TileLang | JIT | 0 | 0 |

### 运行性能

| 尺寸 | 框架 | 延迟(ms) | TFLOPS |
|------|------|----------|--------|
| 1024x1024 | Triton | 0.023 | N/A |
| | | | |
| 256x256 | Triton | 0.033 | N/A |
| | | | |
| 4096x4096 | Triton | 0.030 | N/A |
| | | | |
| 8192x8192 | Triton | 0.058 | N/A |
| | | | |

## LAYERNORM 核函数对比

### 编译性能

| 框架 | 类型 | Warmup(ms) | 编译时间(ms) |
|------|------|------------|--------------|
| cuBLAS | AOT | - | 0 |
| CUTLASS | AOT | - | 0 |
| Triton | JIT | 307 | 0 |
| TileLang | JIT | 0 | 0 |

### 运行性能


## 综合对比

| 核函数 | 框架 | 平均延迟(ms) | 最高性能 |
|--------|------|--------------|----------|
| gemm | cuBLAS | 0.232 | 141915.00 |
| gemm | CUTLASS | 0.238 | 143795.00 |
| gemm | Triton | 0.270 | 135430.69 |
| gemm | TileLang | 0.262 | 130435.11 |
| softmax | Triton | 0.036 | 0.00 |