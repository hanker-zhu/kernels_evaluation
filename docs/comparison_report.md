# GEMM算子框架性能对比报告

本报告区分 **Warmup时间**、**编译时间** 和 **运行时间**。

## 一、编译性能对比

| 框架 | 类型 | Warmup(ms) | 编译时间(ms) | 说明 |
|------|------|------------|--------------|------|
| cuBLAS | AOT | - | 0 | cmake+make 一次性编译 |
| CUTLASS | AOT | - | 0 | cmake+make 一次性编译 |
| Triton | JIT | 518 | 2 | 每尺寸编译（不含warmup） |
| TileLang | JIT | 1672 | 110 | 每尺寸编译（不含warmup） |

### 时间分布图

```
框架       | Warmup        | 编译          | 说明
----------------------------------------------------------------------
cuBLAS     |               |  0ms | AOT
CUTLASS    |               |  0ms | AOT
Triton     | ██████████ 518ms |  2ms | JIT
TileLang   | █████████████████████████████████ 1672ms | ▓▓ 110ms | JIT
```

## 二、运行性能对比

### 各尺寸性能

| 矩阵尺寸 | 框架 | 运行(ms) | TFLOPS | 单尺寸编译(ms) |
|----------|------|----------|--------|----------------|
| 4096x4096x4096 | CUTLASS | 0.955 | 143967.00 | 0.0 |
| 4096x4096x4096 | cuBLAS | 0.968 | 141956.00 | 0.0 |
| 4096x4096x4096 | Triton | 1.029 | 133594.61 | 0.0 |
| 4096x4096x4096 | TileLang | 1.054 | 130435.11 | 11.1 |
| | | | | |
| 2048x2048x2048 | cuBLAS | 0.135 | 127514.00 | 0.0 |
| 2048x2048x2048 | CUTLASS | 0.165 | 103966.00 | 0.0 |
| 2048x2048x2048 | TileLang | 0.186 | 92182.50 | 11.1 |
| 2048x2048x2048 | Triton | 0.208 | 82729.73 | 0.0 |
| | | | | |
| 1024x1024x1024 | cuBLAS | 0.031 | 69298.70 | 0.0 |
| 1024x1024x1024 | CUTLASS | 0.033 | 64114.70 | 0.0 |
| 1024x1024x1024 | TileLang | 0.040 | 53773.13 | 11.5 |
| 1024x1024x1024 | Triton | 0.071 | 30245.80 | 0.0 |
| | | | | |
| 512x512x512 | cuBLAS | 0.013 | 20341.00 | 0.0 |
| 512x512x512 | TileLang | 0.019 | 13797.05 | 14.6 |
| 512x512x512 | CUTLASS | 0.020 | 13527.80 | 0.0 |
| 512x512x512 | Triton | 0.056 | 4786.99 | 0.0 |
| | | | | |
| 256x256x256 | cuBLAS | 0.011 | 3181.36 | 0.0 |
| 256x256x256 | TileLang | 0.011 | 2978.91 | 61.4 |
| 256x256x256 | CUTLASS | 0.014 | 2461.45 | 0.0 |
| 256x256x256 | Triton | 0.066 | 508.08 | 1.7 |
| | | | | |

### 性能汇总

| 框架 | 平均TFLOPS | 最高TFLOPS | 平均延迟(ms) |
|------|------------|------------|--------------|
| cuBLAS | 72458.21 | 141956.00 | 0.232 |
| CUTLASS | 65607.39 | 143967.00 | 0.237 |
| Triton | 50373.04 | 133594.61 | 0.286 |
| TileLang | 58633.34 | 130435.11 | 0.262 |

## 三、综合分析

### AOT vs JIT 对比

| 特性 | AOT (cuBLAS/CUTLASS) | JIT (Triton/TileLang) |
|------|----------------------|----------------------|
| Warmup | 无 | 首次启动 300-1800ms |
| 编译 | 一次性 (8-17s) | 每尺寸 20-30ms |
| 运行 | 极致性能 | 接近AOT |
| 适用 | 生产环境 | 研究开发 |

### 关键洞察

1. **Warmup开销**：JIT框架首次启动需要加载编译器，约300-1800ms
2. **编译开销**：AOT一次编译长期使用；JIT每个新尺寸需编译20-30ms
3. **运行性能**：大矩阵时 JIT 接近 AOT；小矩阵 AOT 优势明显
4. **总体建议**：生产用AOT，原型开发用JIT