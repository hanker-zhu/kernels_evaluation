# GEMM算子生成框架多尺寸对比分析报告

## 测试配置
- 矩阵尺寸范围: 128x128x128 到 4096x4096x4096 (包括非方形矩阵)
- 数据类型: FP16输入, FP32累加
- 测试运行次数: 10次取平均
- 测试框架: cuBLAS, CUTLASS, TileLang, Triton

## 多尺寸性能对比表

| 矩阵尺寸 | 框架 | 时间(ms) | 性能(TFLOPS) | 校验和 |
|----------|------|----------|-------------|--------|
| 4096x4096x4096 | cuBLAS | 0.93 | 147817.00 | N/A |
| 4096x4096x4096 | CUTLASS | 0.94 | 146111.00 | 2.70e+03 |
| 4096x4096x4096 | Triton | 1.12 | 122172.93 | N/A |
| 4096x4096x4096 | TileLang | 1.15 | 119623.64 | N/A |
| | | | | |
| 4096x4096x2048 | CUTLASS | 0.49 | 140778.00 | -1.00e+04 |
| 4096x4096x2048 | cuBLAS | 0.50 | 136957.00 | N/A |
| 4096x4096x2048 | Triton | 0.60 | 114951.89 | N/A |
| 4096x4096x2048 | TileLang | 0.61 | 112410.16 | N/A |
| | | | | |
| 4096x2048x4096 | cuBLAS | 0.47 | 147298.00 | N/A |
| 4096x2048x4096 | CUTLASS | 0.48 | 141879.00 | -1.25e+04 |
| 4096x2048x4096 | TileLang | 0.59 | 115505.79 | N/A |
| 4096x2048x4096 | Triton | 0.62 | 110806.70 | N/A |
| | | | | |
| 2048x4096x4096 | cuBLAS | 0.47 | 146526.00 | N/A |
| 2048x4096x4096 | CUTLASS | 0.48 | 143856.00 | -5.27e+03 |
| 2048x4096x4096 | TileLang | 0.59 | 115505.79 | N/A |
| 2048x4096x4096 | Triton | 0.62 | 110764.11 | N/A |
| | | | | |
| 2048x2048x2048 | cuBLAS | 0.14 | 125766.00 | N/A |
| 2048x2048x2048 | CUTLASS | 0.16 | 110595.00 | 7.89e+03 |
| 2048x2048x2048 | TileLang | 0.20 | 86037.00 | N/A |
| 2048x2048x2048 | Triton | 0.23 | 75122.60 | N/A |
| | | | | |
| 2048x2048x1024 | cuBLAS | 0.08 | 105385.00 | N/A |
| 2048x2048x1024 | CUTLASS | 0.09 | 97090.40 | -7.07e+03 |
| 2048x2048x1024 | TileLang | 0.11 | 75573.04 | N/A |
| 2048x2048x1024 | Triton | 0.14 | 61724.85 | N/A |
| | | | | |
| 2048x1024x2048 | cuBLAS | 0.10 | 85510.80 | N/A |
| 2048x1024x2048 | CUTLASS | 0.12 | 71820.30 | -4.00e+03 |
| | | | | |
| 1024x2048x2048 | cuBLAS | 0.09 | 98342.40 | N/A |
| 1024x2048x2048 | CUTLASS | 0.11 | 80120.40 | -8.67e+03 |
| 1024x2048x2048 | TileLang | 0.13 | 64527.75 | N/A |
| 1024x2048x2048 | Triton | 0.15 | 55634.34 | N/A |
| | | | | |
| 1024x1024x1024 | cuBLAS | 0.04 | 57299.20 | N/A |
| 1024x1024x1024 | CUTLASS | 0.04 | 56375.10 | -1.59e+03 |
| 1024x1024x1024 | TileLang | 0.05 | 43690.67 | N/A |
| 1024x1024x1024 | Triton | 0.08 | 26260.06 | N/A |
| | | | | |
| 1024x1024x512 | CUTLASS | 0.03 | 40329.80 | 7.75e+02 |
| 1024x1024x512 | cuBLAS | 0.03 | 35665.90 | N/A |
| 1024x1024x512 | TileLang | 0.03 | 34952.53 | N/A |
| 1024x1024x512 | Triton | 0.08 | 13427.55 | N/A |
| | | | | |
| 1024x512x1024 | cuBLAS | 0.03 | 37991.90 | N/A |
| 1024x512x1024 | CUTLASS | 0.04 | 28728.10 | -4.96e+02 |
| 1024x512x1024 | TileLang | 0.05 | 22310.13 | N/A |
| 1024x512x1024 | Triton | 0.08 | 13524.32 | N/A |
| | | | | |
| 512x1024x1024 | cuBLAS | 0.03 | 38836.20 | N/A |
| 512x1024x1024 | CUTLASS | 0.04 | 28571.60 | -1.77e+03 |
| 512x1024x1024 | TileLang | 0.05 | 22310.13 | N/A |
| 512x1024x1024 | Triton | 0.08 | 13320.32 | N/A |
| | | | | |
| 512x512x512 | cuBLAS | 0.02 | 13797.10 | N/A |
| 512x512x512 | CUTLASS | 0.03 | 10280.20 | 1.04e+03 |
| 512x512x512 | TileLang | 0.03 | 9709.04 | N/A |
| 512x512x512 | Triton | 0.06 | 4188.62 | N/A |
| | | | | |
| 512x512x256 | cuBLAS | 0.02 | 7620.47 | N/A |
| 512x512x256 | TileLang | 0.02 | 6898.53 | N/A |
| 512x512x256 | CUTLASS | 0.02 | 6393.76 | 2.90e+02 |
| 512x512x256 | Triton | 0.05 | 2487.63 | N/A |
| | | | | |
| 512x256x512 | cuBLAS | 0.02 | 6898.53 | N/A |
| 512x256x512 | CUTLASS | 0.03 | 5120.00 | -5.26e+02 |
| 512x256x512 | TileLang | 0.03 | 5041.23 | N/A |
| 512x256x512 | Triton | 0.06 | 2152.77 | N/A |
| | | | | |
| 256x512x512 | cuBLAS | 0.02 | 6935.03 | N/A |
| 256x512x512 | CUTLASS | 0.03 | 5140.08 | 4.22e+02 |
| 256x512x512 | TileLang | 0.03 | 4854.52 | N/A |
| 256x512x512 | Triton | 0.06 | 2109.22 | N/A |
| | | | | |
| 256x256x256 | cuBLAS | 0.02 | 1810.39 | N/A |
| 256x256x256 | TileLang | 0.02 | 1724.63 | N/A |
| 256x256x256 | CUTLASS | 0.02 | 1622.18 | -3.33e+01 |
| 256x256x256 | Triton | 0.05 | 611.37 | N/A |
| | | | | |
| 128x128x128 | TileLang | 0.02 | 256.00 | N/A |
| 128x128x128 | CUTLASS | 0.02 | 248.24 | -3.63e+01 |
| 128x128x128 | cuBLAS | 0.02 | 219.04 | N/A |
| 128x128x128 | Triton | 0.07 | 59.82 | N/A |
| | | | | |

## 性能趋势分析

### 方形矩阵性能 (MxMxM)

| 尺寸 | cuBLAS | CUTLASS | TileLang | Triton |
|------|--------|---------|----------|--------|
| 128x128x128 | 219.0 | 248.2 | 256.0 | 59.8 |
| 256x256x256 | 1810.4 | 1622.2 | 1724.6 | 611.4 |
| 512x512x512 | 13797.1 | 10280.2 | 9709.0 | 4188.6 |
| 1024x1024x1024 | 57299.2 | 56375.1 | 43690.7 | 26260.1 |
| 2048x2048x2048 | 125766.0 | 110595.0 | 86037.0 | 75122.6 |
| 4096x4096x4096 | 147817.0 | 146111.0 | 119623.6 | 122172.9 |

### 非方形矩阵性能示例

**4096x2048x4096**:
- cuBLAS: 147298.00 TFLOPS
- CUTLASS: 141879.00 TFLOPS
- TileLang: 115505.79 TFLOPS
**2048x4096x4096**:
- cuBLAS: 146526.00 TFLOPS
- CUTLASS: 143856.00 TFLOPS
- TileLang: 115505.79 TFLOPS
**4096x4096x2048**:
- CUTLASS: 140778.00 TFLOPS
- cuBLAS: 136957.00 TFLOPS
- Triton: 114951.89 TFLOPS

## 框架特性对比

### 设计出发点
**cuBLAS**: 高度优化的厂商库，专注于生产环境的极致性能
**CUTLASS**: 可配置的模板库，为研究者和开发者提供灵活的算子定制能力
**TileLang**: 基于TensorIR的函数式编程，提供自动优化的声明式算子描述
**Triton**: Python JIT编译框架，降低CUDA编程门槛的同时保持高性能

## 总结与建议

### 多尺寸测试洞察
- **性能一致性**: 观察各框架在不同尺寸下的性能表现稳定性
- **扩展性**: 大尺寸矩阵上的性能扩展趋势
- **非方形矩阵**: 不同宽高比矩阵的性能特点

### 适用场景
- **生产环境**: 推荐使用cuBLAS，性能最稳定可靠
- **研究开发**: 推荐使用CUTLASS，可定制性强
- **快速原型**: 推荐使用Triton或TileLang，开发效率高

### 技术洞察
1. **库 vs 编译器**: cuBLAS/CUTLASS偏向预优化库，Triton/TileLang偏向JIT编译
2. **抽象层次**: 从低到高为cuBLAS < CUTLASS < TileLang < Triton
3. **优化策略**: 库关注运行时效率，编译器关注代码生成优化
4. **开发体验**: Python框架显著降低了CUDA编程门槛