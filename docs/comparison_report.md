# GEMM算子框架性能对比报告

本报告区分 **Warmup时间**、**编译时间** 和 **运行时间**。

## 一、编译性能对比

| 框架 | 类型 | Warmup(ms) | 编译时间(ms) | 说明 |
|------|------|------------|--------------|------|
| cuBLAS | AOT | - | 0 | cmake+make 一次性编译 |
| CUTLASS | AOT | - | 0 | cmake+make 一次性编译 |
| Triton | JIT | 367 | 1 | 每尺寸编译（不含warmup） |
| TileLang | JIT | 478 | 118 | 每尺寸编译（不含warmup） |

### 时间分布图

```
框架       | Warmup        | 编译          | 说明
----------------------------------------------------------------------
cuBLAS     |               |  0ms | AOT
CUTLASS    |               |  0ms | AOT
Triton     | ███████ 367ms |  1ms | JIT
TileLang   | █████████ 478ms | ▓▓ 118ms | JIT
```

## 二、运行性能对比

### 各尺寸性能

| 矩阵尺寸 | 框架 | 运行(ms) | TFLOPS | 单尺寸编译(ms) |
|----------|------|----------|--------|----------------|
| 4096x4096x4096 | cuBLAS | 0.930 | 147801.00 | 0.0 |
| 4096x4096x4096 | CUTLASS | 0.941 | 146127.00 | 0.0 |
| 4096x4096x4096 | Triton | 1.122 | 122450.61 | 0.0 |
| 4096x4096x4096 | TileLang | 1.151 | 119410.80 | 21.6 |
| | | | | |
| 2048x2048x2048 | cuBLAS | 0.140 | 122820.00 | 0.0 |
| 2048x2048x2048 | CUTLASS | 0.155 | 110741.00 | 0.0 |
| 2048x2048x2048 | TileLang | 0.199 | 86480.50 | 23.6 |
| 2048x2048x2048 | Triton | 0.227 | 75611.33 | 0.0 |
| | | | | |
| 1024x1024x1024 | cuBLAS | 0.039 | 55188.20 | 0.0 |
| 1024x1024x1024 | CUTLASS | 0.050 | 43329.60 | 0.0 |
| 1024x1024x1024 | TileLang | 0.050 | 42799.02 | 24.5 |
| 1024x1024x1024 | Triton | 0.080 | 26775.27 | 0.0 |
| | | | | |
| 512x512x512 | cuBLAS | 0.020 | 13724.80 | 0.0 |
| 512x512x512 | CUTLASS | 0.026 | 10320.60 | 0.0 |
| 512x512x512 | TileLang | 0.028 | 9709.04 | 25.8 |
| 512x512x512 | Triton | 0.064 | 4221.60 | 0.0 |
| | | | | |
| 256x256x256 | CUTLASS | 0.021 | 1606.27 | 0.0 |
| 256x256x256 | TileLang | 0.021 | 1560.38 | 23.0 |
| 256x256x256 | cuBLAS | 0.022 | 1545.66 | 0.0 |
| 256x256x256 | Triton | 0.082 | 408.76 | 1.2 |
| | | | | |

### 性能汇总

| 框架 | 平均TFLOPS | 最高TFLOPS | 平均延迟(ms) |
|------|------------|------------|--------------|
| cuBLAS | 68215.93 | 147801.00 | 0.230 |
| CUTLASS | 62424.89 | 146127.00 | 0.238 |
| Triton | 45893.51 | 122450.61 | 0.315 |
| TileLang | 51991.95 | 119410.80 | 0.290 |

## 三、综合分析

### AOT vs JIT 对比

| 特性 | AOT (cuBLAS/CUTLASS) | JIT (Triton/TileLang) |
|------|----------------------|----------------------|
| Warmup | 无 | 首次启动 300-1800ms |
| 编译 | 一次性 (8-17s) | 每尺寸 20-30ms |
| 运行 | 极致性能 | 接近AOT |
| 适用 | 生产环境 | 研究开发 |

### 关键洞察

1. **Warmup开销**：JIT框架首次启动需要加载编译器，约300-1800ms
2. **编译开销**：AOT一次编译长期使用；JIT每个新尺寸需编译20-30ms
3. **运行性能**：大矩阵时 JIT 接近 AOT；小矩阵 AOT 优势明显
4. **总体建议**：生产用AOT，原型开发用JIT